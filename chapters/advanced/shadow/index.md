## 阴影贴图

阴影贴图（Shadow Map）也称深度贴图（Depth Map），实现的核心思路是：太阳看不到阴影。因此在光源位置放置一个摄像机，摄像机能看到的区域就是光照能照到的区域，而摄像机看不到的区域就是阴影的区域。阴影贴图的实现逻辑就基于这种思路，我们需要计算光源到每个物体之间的距离（即光源位置下的摄像机计算出来的深度 z 值），通过比较每个物体之间的距离来决定物体是否可见。

要实现阴影贴图，需要用到两个程序完成两个流程：

1. 第一个程序用于计算光源到各个物体的距离，确定哪些位置可见哪些位置不可见。即记录每个物体的经过模型视图投影矩阵变换之后，每个像素的深度 z 值，并保存最小的 z 值（距离摄像机最近）。实际上就是深度缓冲区所实现的功能，这个程序的最终结果就是输出一个深度缓冲区。此处需要使用更换帧缓冲区的功能。
2. 第二个程序用于绘制实际的可视场景。但此时我们需要将每一个计算出来的像素的深度 z 值 $z_1$ 与第一个程序输出的深度缓冲区对应像素位置的 z 值 $z_0$ 进行比较，如果 $z_1$ 小于 $z_0$，就是阴影区域，阴影区域将使用更暗的颜色绘制，以实现阴影的视觉效果。

# 精度